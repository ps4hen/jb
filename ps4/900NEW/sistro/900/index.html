<html>
<head>
<title>GoldHEN V2.4b16.2 [9.00]</title>
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="../../favicon.ico">
<meta charset="windows-1251">
<link rel="stylesheet" href="../../style.css">
<style>
 button
 {
 width:45px; 
 height:45px;
 color: red;
 background-color: red;
 border-radius: 45px;
 }
 #tc
 {
 padding-top:5%;
 }
#henka
{
margin-left:-50px;
height:300px; 
position: relative 
}
body
{
line-height:40px
}
</style>
<script src="int64.js"></script>
<script src="rop.js"></script>
<script src="kexploit.js"></script>
<script type="module" src="alert.mjs"></script>
<script>

function loadBIN(){

			var xhr = new XMLHttpRequest();
			xhr.open('GET', "goldhen.bin", true);
			xhr.overrideMimeType('text/plain; charset=x-user-defined');
			xhr.onload = function(e) {
			if (this.status == 200) {
				payload = this.response;
				SendPayload();
				allset();
			}
			else
			{
				alert("Failed to load ");
		        return;
			}};
			xhr.send();
	   }
	
function SendPayload() {
	   var payload_buffer = chain.syscall(477, new int64(0x26200000, 0x9), 0x300000, 7, 0x41000, -1, 0);
       var bufLen = payload.length;
       var payload_loader = p.malloc32(bufLen);
       var loader_writer = payload_loader.backing;
       for(var i=0;i<bufLen/4;i++){
            var hxVal = payload.slice(i*4,4+(i*4)).split("").reverse().join("").split("").map(function(s){return("0000" + s.charCodeAt(0).toString(16)).slice(-2);}).join("");
            loader_writer[i] = parseInt(hxVal, 16);
       }
       chain.syscall(74, payload_loader, bufLen, (0x1 | 0x2 | 0x4));
       var pthread = p.malloc(0x10);
       chain.call(libKernelBase.add32(OFFSET_lk_pthread_create), pthread, 0x0, payload_loader, payload_buffer);
}

function allset() {
       document.getElementById("log").innerHTML = "<div style='color: green'>GoldHEN ЗАГРУЖЕН!<br/> Извлеките флешку и нажмите кнопку PS для выхода</div>";
}

function jbdone(){
   document.getElementById("log").innerHTML = ("<div style='color: yellow'>Возможна внезапная перезагрузка или зависание <br/> ждите...</div>");
    setTimeout(loadBIN,1000);
}

 
</script>
</head>
<body>
<div id="log1" style="position: absolute; top:0; left:0"></div>
<div id="tc">
<img src="../hen.gif" id="henka">
<h3>
<div id="log">ЖДИТЕ СООБЩЕНИЕ...<br>не трогайте джойстик!</div>
 <div id="progress" style="display:none"></div>
</h3>
</div>
<div style="position:absolute; width:99%; bottom:0; padding: 5px" id="mess"><a href="HEN_9.00_files.zip" style="color:yellow;" target="_blank">Скачать файлы для USB флешки</a>  </div>

</body>

</html>
